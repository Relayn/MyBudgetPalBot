# Финансовый бот-помощник (MyBudgetPalBot)

![Python](https://img.shields.io/badge/Python-3.8%2B-blue?style=for-the-badge&logo=python)
![aiogram](https://img.shields.io/badge/aiogram-v3-blueviolet?style=for-the-badge&logo=telegram)
![SQLite](https://img.shields.io/badge/SQLite-DB-green?style=for-the-badge&logo=sqlite)
![License](https://img.shields.io/badge/License-MIT-yellow.svg?style=for-the-badge)

## О проекте

**MyBudgetPalBot** — это Telegram-бот, разработанный для помощи пользователям в управлении личными финансами. Он предоставляет функционал для регистрации, отслеживания курсов валют, получения советов по экономии и ведения учета расходов по различным категориям.

Проект создан с использованием современных асинхронных подходов в Python и фреймворка `aiogram v3`.

## Основные возможности

*   **Регистрация пользователя**: Простая регистрация в базе данных для отслеживания личных финансов.
*   **Курс валют**: Получение актуальных курсов USD к RUB и EUR к RUB через внешний API.
*   **Советы по экономии**: Рандомная выдача советов по финансовой грамотности.
*   **Учет личных финансов**: Пошаговый ввод расходов по трем заданным категориям с помощью конечного автомата (FSM) и сохранение данных в базу данных.
*   **Отмена действий**: Возможность отменить текущий диалог с ботом командой `/cancel` или словом "отмена".

## Используемые технологии

*   **Python 3.8+**: Язык программирования.
*   **[aiogram v3](https://docs.aiogram.dev/)**: Современный и асинхронный фреймворк для разработки Telegram ботов.
*   **[aiohttp](https://docs.aiohttp.org/en/stable/)**: Асинхронная HTTP-клиентская библиотека для запросов к внешним API (например, для курсов валют).
*   **[aiosqlite](https://aiosqlite.omnilib.dev/en/stable/)**: Асинхронный драйвер для работы с базой данных SQLite.
*   **[python-dotenv](https://pypi.org/project/python-dotenv/)**: Для загрузки переменных окружения из файла `.env` (безопасное хранение токенов).
*   **[pytest](https://docs.pytest.org/en/stable/)** и **[pytest-asyncio](https://pytest-asyncio.readthedocs.io/en/latest/)**: Для написания и запуска асинхронных тестов (частично реализовано).

## Установка и запуск

Следуйте этим шагам, чтобы развернуть и запустить бота на вашей локальной машине.

### 1. Клонирование репозитория

```bash
git clone https://github.com/Relayn/MyBudgetPalBot.git
cd MyBudgetPalBot
```

### 2. Создание и активация виртуального окружения

Настоятельно рекомендуется использовать виртуальное окружение для управления зависимостями.

```bash
# Создать виртуальное окружение
python -m venv .venv

# Активировать виртуальное окружение
# Для Windows (PowerShell):
.venv\Scripts\Activate.ps1
# Для Windows (Command Prompt - cmd.exe):
.venv\Scripts\activate.bat
# Для macOS / Linux:
source .venv/bin/activate
```
После активации виртуального окружения в начале строки терминала появится `(.venv)`.

### 3. Установка зависимостей

Установите все необходимые библиотеки из `requirements.txt`:

```bash
pip install -r requirements.txt
```

### 4. Настройка переменных окружения (`.env`)

Создайте файл `.env` в корневой директории проекта и добавьте в него ваш токен Telegram бота и API-ключ для курсов валют. **НЕ публикуйте этот файл в открытом доступе!**

```dotenv
# .env
BOT_TOKEN="ВАШ_ТЕЛЕГРАМ_БОТ_ТОКЕН"
EXCHANGE_RATE_API_KEY="ВАШ_API_КЛЮЧ_EXCHANGERATE"
```
*   **`BOT_TOKEN`**: Получите его от [@BotFather](https://t.me/BotFather) в Telegram (команда `/newbot`).
*   **`EXCHANGE_RATE_API_KEY`**: Зарегистрируйтесь на [ExchangeRate-API.com](https://www.exchangerate-api.com/) и получите свой бесплатный API-ключ.

### 5. Запуск бота

После выполнения всех предыдущих шагов, вы можете запустить бота:

```bash
python main.py
```
Бот начнет опрос Telegram API, и вы увидите логи в консоли, а также в файле `bot.log`.

### 6. Остановка бота

Чтобы остановить бота, нажмите `Ctrl + C` в терминале.

## Команды бота для BotFather

Для удобства пользователей, вы можете зарегистрировать следующие команды для вашего бота через [@BotFather](https://t.me/BotFather) (используйте команду `/setcommands`):

```
start - Начать работу с ботом и показать главное меню
cancel - Отменить текущее действие и выйти из диалога
```

## Структура проекта

Проект организован модульно для улучшения читаемости и поддерживаемости кода:

```
MyBudgetPalBot/
├── .env                  # Переменные окружения (игнорируется Git'ом)
├── .gitignore            # Правила игнорирования файлов для Git
├── requirements.txt      # Список зависимостей проекта
├── main.py               # Главный файл запуска бота, инициализация диспетчера и регистрация роутеров
├── config.py             # (Опционально) Общие настройки, не являющиеся секретами
├── states.py             # Определение состояний FSM для диалогов
├── keyboards/            # Модули для определения клавиатур
│   └── reply.py          # Reply-клавиатуры
├── database/             # Модули для работы с базой данных
│   └── db.py             # Функции для инициализации и получения соединения с БД
└── handlers/             # Модули с обработчиками команд и сообщений
    ├── start.py          # Хэндлер команды /start
    ├── registration.py   # Хэндлер для регистрации пользователя
    ├── exchange.py       # Хэндлер для курсов валют
    ├── tips.py           # Хэндлер для советов по экономии
    ├── finances.py       # Хэндлеры FSM для учета личных финансов и команда /cancel
    └── other.py          # Хэндлер для необработанных сообщений
```

## Дальнейшие улучшения

Проект можно расширять и улучшать в следующих направлениях:

*   **Расширение функционала финансов**: Добавление отчетов (месячных/годовых), графиков, просмотра ранее введенных данных.
*   **Уведомления**: Возможность настройки напоминаний о необходимости внесения расходов.
*   **Категории**: Гибкое управление категориями пользователем (добавление/удаление).
*   **Аутентификация**: Более сложная система аутентификации, если потребуется.
*   **Тестирование**: Полное покрытие кода автоматизированными тестами с использованием `pytest`.
*   **Развертывание**: Инструкции по развертыванию на удаленном сервере (например, Heroku, Railway, VPS).

---

## Лицензия

Этот проект распространяется под лицензией MIT. Подробности см. в файле `LICENSE` (если он есть).


